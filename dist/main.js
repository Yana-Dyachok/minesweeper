(()=>{"use strict";document.body.setAttribute("class","body change");const e=document.createElement("div");e.setAttribute("class","wrapper"),document.body.append(e);const t=document.createElement("header");t.setAttribute("class","header");const n=document.createElement("div");n.setAttribute("class","clock-face");const s=document.createElement("div");s.setAttribute("class","first-row");const a=document.createElement("div");a.setAttribute("class","level-block");const c=document.createElement("div");c.setAttribute("class","menu-title"),c.textContent="Level: ",a.append(c);const o=document.createElement("select");o.setAttribute("class","level");const i=document.createElement("option");i.value="value1",i.textContent="easy";const l=document.createElement("option");l.value="value2",l.textContent="medium";const r=document.createElement("option");r.value="value3",r.textContent="hard",o.appendChild(i),o.appendChild(l),o.appendChild(r),a.append(o),s.append(a);const d=document.createElement("div");d.setAttribute("class","mine-block");const u=document.createElement("div");u.setAttribute("class","menu-title"),u.textContent=" Mines: ",d.append(u);let m=document.createElement("input");m.setAttribute("class","mine-count"),m.setAttribute("type","number"),m.setAttribute("max","100"),m.setAttribute("maxlength","2"),m.placeholder=10,d.append(m),s.append(d);const p=document.createElement("div");p.setAttribute("class","second-row");const f=document.createElement("div");f.setAttribute("class","theme-toggle change"),p.append(f);const g=document.createElement("div");g.setAttribute("class","smile"),p.append(g);const b=document.createElement("div");b.setAttribute("class","smiley-face"),g.append(b);const h=document.createElement("div");h.setAttribute("class","eye-left"),b.append(h);const v=document.createElement("div");v.setAttribute("class","eye-right"),b.append(v);const E=document.createElement("div");E.setAttribute("class","mouth"),b.append(E);const A=document.createElement("div");A.setAttribute("class","mike change");const x=document.createElement("audio");x.setAttribute("class","audio-lost"),x.src="./assets/audio/ou_nou_nou_nou.mp3",A.append(x);const y=document.createElement("audio");y.setAttribute("class","audio-win"),y.src="./assets/audio/Queen_We_Are_The_Champions.mp3",A.append(y);const L=document.createElement("audio");L.setAttribute("class","audio-opened"),L.src="./assets/audio/neobyichnyiy-zvuk-knopki1.mp3",A.append(L);const k=document.createElement("audio");k.setAttribute("class","audio-my-mine"),k.src="./assets/audio/zvonkiy-zvuk-najatiya-knopki1.mp3",A.append(k),p.append(A);const C=document.createElement("div");C.setAttribute("class","third-row");const w=document.createElement("div");w.setAttribute("class","click-points");const S=document.createElement("div");S.setAttribute("class","flag"),S.innerHTML='<img src="./assets/img/Flag-green256_25053.png" alt="flag" width="30"  height="30">',w.append(S);const I=document.createElement("div");I.setAttribute("class","point-bombs change"),w.append(I);const M=document.createElement("div");M.setAttribute("class","menu-title"),M.textContent="Clicks: ",w.append(M);const T=document.createElement("div");T.setAttribute("class","point-clicks change"),T.textContent=0,w.append(T),C.append(w);const _=document.createElement("div");_.setAttribute("class","time-game");const q=document.createElement("div");q.setAttribute("class","menu-title"),_.append(q),q.textContent="Time: ";const O=document.createElement("div");O.setAttribute("class","time-game change"),O.textContent="00:00",_.append(O),C.append(_),n.append(s),n.append(p),n.append(C),t.append(n),e.append(t);const H=document.createElement("main");H.setAttribute("class","main");const N=document.createElement("div");N.setAttribute("class","playing-field"),H.append(N),e.append(H);const G=document.createElement("footer");G.setAttribute("class","footer");const Y=document.createElement("h3");Y.setAttribute("class","text-footer change");const z=document.createElement("div");G.append(Y),G.append(z),e.append(G);const D=document.createElement("ul");D.setAttribute("class","overlay"),document.body.append(D);let j=parseInt(m.value)||10,J=10,$=10,F=[],Q=0,W=!1,B=j,K=0;I.innerText=B;let P,R=!1,U=!1,V=localStorage.getItem("level")||"easy",X=0,Z=!1,ee=!0;class te{constructor(){this.isMine=!1,this.nearMine=0,this.isOpen=!1}}function ne(e,t){J=e,$=e,j=t}function se(e){"easy"===e&&ne(10,10),"medium"===e&&ne(15,40),"hard"===e&&ne(25,70),m.placeholder=j,I.innerText=j}function ae(){if(U)X=O.textContent;else if(W){let e=~~((new Date-P)/1e3),t=~~(e/60),n=e%60;O.textContent=`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}}function ce(){const e=document.querySelector(".table-boxes");for(let t=0;t<J;t++)for(let n=0;n<$;n++){let s=e.rows[n].children[t];F[t][n].isMine&&s.classList.add("mine")}}function oe(e,t){let n=t>0?t-1:t,s=e<J-1?e+1:e,a=t<$-1?t+1:t,c=0;for(let o=e>0?e-1:e;o<=s;o++)for(let s=n;s<=a;s++)!F[o][s].isMine||e==o&&t==s||c++;F[e][t].nearMine=c,F[e][t].innerHTML=c}function ie(e){U||(de(e.target.cellIndex,e.target.parentNode.rowIndex),document.querySelectorAll("td").forEach((e=>{switch(e.textContent){case"1":e.classList.add("one");break;case"2":e.classList.add("two");break;case"3":e.classList.add("three");break;case"4":e.classList.add("four");break;case"5":e.classList.add("five")}})))}function le(e){A.classList.contains("off")?e.pause():e.play()}function re(){A.classList.contains("off")?(k.pause(),x.pause(),L.pause(),y.pause()):("You lost!!!"===Y.textContent&&x.play(),"Greeting!!! You win!!!"===Y.textContent&&y.play())}function de(e,t){let n=document.querySelector(".table-boxes").rows[t].children[e];if(!F[e][t].isOpen)if(F[e][t].isMine)n.classList.add("mine"),ce(),Y.textContent="You lost!!!",U=!0,W=!1,E.style.animation="mouth 1s infinite",le(x),he(O.textContent);else if(0==F[e][t].nearMine?n.innerHTML="":n.innerHTML=F[e][t].nearMine,F[e][t].isOpen=!0,n.classList.add("opened"),n.classList.remove("my-mine"),le(L),Q++,J*$-j==Q&&(Y.textContent="Greeting!!! You win!!!",W=!1,U=!0,ce(),le(y),h.style.animation="eye 1s infinite",v.style.animation="eye 1s infinite",E.style.animation="mouth 1s infinite",he(O.textContent)),0==F[e][t].nearMine){let n=t>0?t-1:t,s=e+1<J?e+1:e,a=t+1<$?t+1:t;for(let t=e>0?e-1:e;t<=s;t++)for(let e=n;e<=a;e++)de(t,e)}}function ue(){Q=0,function(){F=[];for(let e=0;e<J;e++){let e=[];for(let t=0;t<$;t++)e.push(new te);F.push(e)}R=!1}(),function(){N.innerHTML="";const e=document.createElement("table");e.setAttribute("class","table-boxes");for(let t=0;t<$;t++){const t=document.createElement("tr");for(let e=0;e<J;e++){const e=document.createElement("td");e.setAttribute("class","rows-boxes change"),f.classList.contains("dark")&&e.classList.add("dark"),t.append(e)}e.append(t)}N.append(e)}(),Y.textContent="Good Luck!!!"}o.addEventListener("change",(function(){let e=o.options[o.selectedIndex];V=e.textContent,pe(),se(V),ue()})),m.addEventListener("change",(function(){j=parseInt(m.value),m.placeholder=j,I.innerText=j,ue()})),A.addEventListener("click",(()=>{A.classList.toggle("off"),re(),ee=!A.classList.contains("off"),pe()})),N.addEventListener("click",(function(e){T.textContent=++K,W=!0,R?e.target.matches("td")&&!e.target.matches(".my-mine")&&ie(e):(P=new Date,setInterval(ae,1e3),e.target.classList.add("opened"),function(e,t){for(let n=0;n<j;){let s=~~(Math.random()*J),a=~~(Math.random()*$);s!==e&&a!==t&&0==F[s][a].isMine&&(F[s][a].isMine=!0,n++)}!function(){for(let e=0;e<J;e++)for(let t=0;t<$;t++)oe(e,t)}()}(e.target.cellIndex,e.target.parentNode.rowIndex),ie(e),R=!0)})),N.addEventListener("contextmenu",(function(e){W=!0,e.preventDefault(),le(k),e.target.matches("td")&&function(e){if(U)return;const t=document.querySelectorAll(".rows-boxes");let n=e.target.cellIndex,s=e.target.parentNode.rowIndex;if(F[n][s].isOpen)return;e.target.classList.toggle("my-mine");const a=Array.from(t).filter((e=>e.classList.contains("my-mine")));B=j-a.length,B>=0?I.innerText=B:(I.innerText=0,e.target.classList.remove("my-mine"))}(e)})),ue(),f.addEventListener("click",(()=>{document.querySelectorAll(".change").forEach((e=>e.classList.toggle("dark"))),Z=!!f.classList.contains("dark"),pe()}));const me=document.querySelector('script[src="./index.js"]');function pe(){localStorage.setItem("mike",ee),localStorage.setItem("theme",Z),localStorage.setItem("level",V)}document.body.append(me),g.addEventListener("click",(function(){location.reload()})),window.getComputedStyle(E);const fe="duration",ge=localStorage.getItem(fe),be=ge?JSON.parse(ge):[];function he(e){be.push(e),be.length>10&&be.shift(),localStorage.setItem(fe,JSON.stringify(be)),function(e){z.textContent="Game statistics:",z.setAttribute("class","stat-block");for(let t=0;t<e.length;t++){const n=document.createElement("li");n.textContent=e[t],z.append(n)}}(be)}window.addEventListener("load",(function(){if(localStorage.getItem("mike")&&(ee=localStorage.getItem("mike"),"false"===ee?A.classList.add("off"):A.classList.remove("off"),re()),localStorage.getItem("theme")){Z=localStorage.getItem("theme");const e=document.querySelectorAll(".change");"true"===Z?e.forEach((e=>e.classList.add("dark"))):e.forEach((e=>e.classList.remove("dark")))}localStorage.getItem("level")&&(se(localStorage.getItem("level")),function(e){Array.from(o.children).forEach((t=>{t.textContent===e&&(t.selected=!0)}))}(V),ue())})),window.addEventListener("beforeunload",pe)})();